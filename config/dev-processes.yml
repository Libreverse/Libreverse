# This is just a procfile named differently
phusion-passenger: cd .. && while ! nc -z localhost 4000 2>/dev/null || ! nc -z localhost 5432 2>/dev/null; do sleep 1; done && perl scripts/wait_for_db.pl RUBYOPT="--yjit --yjit-exec-mem-size=2 --yjit-mem-size=3 --yjit-call-threshold=1 --yjit-cold-threshold=1000000  --yjit-disable --yjit-stats=quiet" bundle exec passenger start -a 127.0.0.1 -p 3002 --environment development --min-instances 2 --max-pool-size 2
vite: cd .. && bin/vite dev | sed -r 's/\x1B\[[0-9;]*[A-Za-z]//g'
shakapacker-asset-server: cd .. && bin/shakapacker-dev-server
shakapacker-client: cd .. && CLIENT_BUNDLE_ONLY=yes bin/shakapacker-isr
shakapacker-server: cd .. && SERVER_BUNDLE_ONLY=yes bin/shakapacker --watch
solid-queue: cd .. && while ! nc -z localhost 4000 2>/dev/null || ! nc -z localhost 5432 2>/dev/null; do sleep 1; done && perl scripts/wait_for_db.pl RUBYOPT="--yjit --yjit-exec-mem-size=2 --yjit-mem-size=3 --yjit-call-threshold=1 --yjit-cold-threshold=1000000" bin/jobs > /dev/null 2>&1
mailhog: cd .. && mailhog | grep -v "\[APIv1\] KEEPALIVE /api/v1/events"
tidb: podman run -p 4000:4000 --rm --name libreverse-dev-tidb --replace pingcap/tidb:latest > /dev/null 2>&1
postgres: podman run -p 5432:5432 --rm --name libreverse-dev-postgres --replace -e POSTGRES_PASSWORD=password -e POSTGRES_DB=libreverse_development postgres:15-alpine > /dev/null 2>&1
rails-db-creator: export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES && export DISABLE_SPRING=1 && cd .. && while ! nc -z localhost 4000 2>/dev/null || ! nc -z localhost 5432 2>/dev/null; do sleep 1; done && while ! mysql -h 127.0.0.1 -P 4000 -u root -e "SELECT 1;" >/dev/null 2>&1; do sleep 1; done && RUBYOPT="--yjit --yjit-exec-mem-size=2 --yjit-mem-size=3 --yjit-call-threshold=1 --yjit-cold-threshold=1000000 " bin/rails db:create db:migrate db:seed && counter=0; basefile="/tmp/.db_creator_done"; filename="${basefile}.txt"; while [ -f "$filename" ]; do counter=$((counter+1)); filename="${basefile}_${counter}.txt"; done && touch "$filename" && sleep 3 && rm "$filename" > /dev/null 2>&1 && echo "This process has done the one time task it needs to do. Exit code zero and overmind continuing is normal."
dragonflydb: podman run -p 6379:6379 --rm --name libreverse-dev-dragonflydb --replace --ulimit memlock=-1 docker.dragonflydb.io/dragonflydb/dragonfly --logtostderr > /dev/null 2>&1 | grep -v "TLS is not"
stimulus-manifest-regenerator: cd .. && bin/manifest-isr
electron: cd .. && while ! [ "$(curl -s -o /dev/null -w "%{http_code}" http://localhost:3002/up)" = "200" ]; do sleep 1; done && exec bun start
dev-proxy: cd .. && APP_PORT=3002 CADDY_PORT=3000 ./scripts/start-http3-dev.sh > /dev/null 2>&1
