# Solid Queue Configuration
# Configure dispatchers, workers, and schedulers for different environments

development:
  dispatchers:
    - polling_interval: 1
      batch_size: 500
  workers:
    - queues: "*"
      threads: 1
  scheduler:
    recurring_schedule_file: config/recurring.yml

test:
  dispatchers:
    - polling_interval: 1
      batch_size: 500
  workers:
    - queues: "*"
      threads: 1
  scheduler:
    recurring_schedule_file: config/recurring.yml

production:
  dispatchers:
    - polling_interval: 1
      batch_size: 500
  workers:
    - queues: "*"
  # Use thread budget if provided; default to safe small numbers otherwise
  threads: <%= (ENV["SOLID_QUEUE_THREADS_PER_PROCESS"] || 2).to_i %>
  processes: <%= (ENV["SOLID_QUEUE_PROCESSES"] || 1).to_i %>
  scheduler:
    recurring_schedule_file: config/recurring.yml
