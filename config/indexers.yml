# Indexer Configuration
# This file configures the various content indexers available in the system
# Each indexer can be enabled/disabled and configured independently

indexers:
    decentraland:
        enabled: true
        rate_limit: 5 # More conservative - 5 requests per second
        batch_size: 25 # Smaller batches
        cache_duration: 3600 # seconds
        api_endpoints:
            # Using Catalyst Network Content Service for scene data
            catalyst_content: "https://peer.decentraland.org/content"
            ipfs_gateway: "https://ipfs.io"
        schedule: "0 */12 * * *" # cron format - every 12 hours
        max_items: 50 # Maximum items per run
        daily_limit: 100 # Maximum items per day (progressive indexing)
        timeout: 45 # Longer timeout per API request
        batch_delay: 2 # Seconds to wait between batches

    sandbox:
        enabled: false # Disabled due to Cloudflare bot protection blocking datacenter IPs
        rate_limit: 5 # Conservative rate limiting
        batch_size: 50
        cache_duration: 7200 # 2 hours
        sitemap_url: "https://www.sandbox.game/__sitemap__/experiences.xml"
        schedule: "0 */6 * * *" # every 6 hours
        max_items: 2000 # Should cover all ~1600 experiences with room for growth
        timeout: 60 # Longer timeout for browser operations

    spatial:
        enabled: true
        rate_limit: 3 # Conservative rate limiting - 3 requests per second
        batch_size: 20 # Smaller batches to be respectful
        cache_duration: 0 # No caching for fresh sitemap data
        sitemap_url: "https://www.spatial.io/root.xml"
        schedule: "0 */8 * * *" # every 8 hours
        max_items: 100 # 100 spaces per run
        timeout: 30 # Standard timeout
        batch_delay: 2 # 2 seconds between batches

    neos:
        enabled: false # Disabled - API is currently broken but ready for when it comes back
        rate_limit: 2 # Very conservative - 2 requests per second for when API returns
        batch_size: 25 # Small batches for API
        cache_duration: 3600 # 1 hour cache for category pages and sessions
        api_url: "https://api.neos.com/api/sessions"
        schedule: "0 */8 * * *" # every 8 hours
        max_items: 100 # Maximum sessions/spaces per run
        timeout: 30 # Standard timeout for web requests
        batch_delay: 3 # 3 seconds between batches to be extra respectful

# Global settings that apply to all indexers
global:
    default_timeout: 30 # seconds
    max_retries: 3 # number of retry attempts
    retry_delay: 5 # seconds between retries
    log_level: "info" # debug, info, warn, error
    enable_caching: true
    cache_backend: "memory" # memory, redis (if available)

# Environment-specific overrides
development:
    global:
        log_level: "debug"
    indexers:
        decentraland:
            max_items: 10 # Limit items in development
            daily_limit: 20 # Small daily limit for testing progressive indexing
            schedule: null # Disable scheduling in development
        sandbox:
            max_items: 5
            schedule: null
            enabled: false # Keep disabled even in development until Cloudflare issue resolved
        spatial:
            max_items: 10 # Limit items in development
            schedule: null # Disable scheduling in development
        neos:
            max_items: 5 # Test with 5 sessions in development
            schedule: null # Disable scheduling in development
            enabled: false # Keep disabled until API is working

test:
    global:
        log_level: "error"
    indexers:
        decentraland:
            enabled: false # Disable all indexers in test
        sandbox:
            enabled: false
        spatial:
            enabled: false
        neos:
            enabled: false
        roblox:
            enabled: false
        axie_infinity:
            enabled: false
        illuvium:
            enabled: false

production:
    global:
        log_level: "info"
        max_retries: 5
        cache_backend: "redis" # Use Redis in production if available
