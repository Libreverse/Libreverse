#!/usr/bin/env bash
echo "Starting local databases..."

# Check TiDB (MacOS Service)
if ! nc -z localhost 4000; then
    echo "TiDB is not running on port 4000. Attempting to start via launchctl..."
    launchctl load ~/Library/LaunchAgents/com.pingcap.tidb.plist
else
    echo "TiDB is running."
fi

# Check Valkey (Homebrew Service)
if ! nc -z localhost 6379; then
    echo "Valkey is not running on port 6379. Attempting to start via brew services..."
    brew services start valkey
else
    echo "Valkey is running."
fi

echo "Databases started."