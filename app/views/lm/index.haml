= render "layouts/sidebar"

= render "layouts/leniswrapper" do
  = render "layouts/navigationshortcutswrapper" do
    #lm-chat{"data-controller" => "webllm"}
      %h1.center Wllama Chat Interface

      .chat-container
        #chat-display.chat-display{"data-webllm-target" => "chatDisplay"}
          .message.system-message
            %strong System:
            Hello! I'm an IBM-Granite & Intel toxic-prompt-roberta powered AI assistant running directly in your browser that can take actions in libreverse on your behalf. Ask me anything!

        #chat-input-container.chat-input-container
          %input#user-input{"data-webllm-target" => "userInput", type: "text", placeholder: "Type your message here..."}
          %button#send-button{"data-webllm-target" => "sendButton", "data-action" => "click->webllm#sendMessage"} Send

      #loading-indicator.loading-indicator{"data-webllm-target" => "loadingIndicator", style: "display: none;"}
        Loading model... This may take a few minutes on first use.

    :css
      .center { text-align: center; }
      .chat-container {
        max-width: 800px;
        margin: 0 auto;
        border: 1px solid #ddd;
        border-radius: 8px;
        height: 600px;
        display: flex;
        flex-direction: column;
      }
      .chat-display {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        background: #f9f9f9;
      }
      .message {
        margin-bottom: 15px;
        padding: 10px;
        border-radius: 8px;
      }
      .user-message {
        background: #007bff;
        color: white;
        margin-left: 100px;
      }
      .assistant-message {
        background: #e9ecef;
        margin-right: 100px;
      }
      .thinking-message {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        font-style: italic;
        margin: 10px 50px;
      }
      .system-message {
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        font-style: italic;
      }
      .chat-input-container {
        display: flex;
        padding: 20px;
        border-top: 1px solid #ddd;
        background: white;
      }
      #user-input {
        flex: 1;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-right: 10px;
      }
      #send-button {
        padding: 10px 20px;
        background: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      #send-button:hover { background: #0056b3; }
      #send-button:disabled { background: #ccc; cursor: not-allowed; }
      .loading-indicator {
        text-align: center;
        padding: 20px;
        background: #fff3cd;
        border: 1px solid #ffeaa7;
        border-radius: 4px;
        margin: 20px auto;
        max-width: 800px;
      }
