# Early overrides: apply before CRS rules so TX variables take effect
# Set default Paranoia Level to 1 (baseline)

# Only set if not already set (CRS uses tx.paranoia_level internally)
# We check a companion flag to avoid overriding when explicitly pinned higher.

# If you ever want PL=3 or 4 in prod, set TX:paranoia_level earlier or via env template.
SecAction \
  "id:10010,phase:1,pass,nolog,\
   setvar:'tx.paranoia_level=1',\
   setvar:'tx.crs_setup_version=330'"

# Increase Request Body Limits for Large Uploads
SecRequestBodyLimit 2147483648  # 2GB max body size
SecRequestBodyNoFilesLimit 1048576  # 1MB for non-file body data
SecRequestBodyInMemoryLimit 524288  # 512KB

# PCRE limits to prevent regex errors during large body scans
SecPcreMatchLimit 500000
SecPcreMatchLimitRecursion 500000
