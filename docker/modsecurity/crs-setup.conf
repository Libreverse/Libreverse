# Libreverse CRS setup (trimmed)
# Base anomaly scoring thresholds (tune later)

SecAction \
 "id:900110, phase:1, nolog, pass, setvar:tx.inbound_anomaly_score_threshold=5"

SecAction \
 "id:900120, phase:1, nolog, pass, setvar:tx.outbound_anomaly_score_threshold=4"

# Paranoia level 1 (default)
SecAction "id:900000, phase:1, nolog, pass, setvar:tx.paranoia_level=1"

# Allow range for arguments length defaults
SecAction "id:900200, phase:1, nolog, pass, setvar:tx.arg_name_length=100,setvar:tx.arg_length=6400,setvar:tx.total_arg_length=64000,setvar:tx.max_num_args=256,setvar:tx.arg_name_length=100"

# Response body limits
SecAction "id:900300, phase:1, nolog, pass, setvar:tx.response_body_limit=524288"

# Enforce blocking mode later by editing SecRuleEngine in modsecurity.conf
