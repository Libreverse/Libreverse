# Libreverse ModSecurity base config (DetectionOnly for tuning)
# Derived from the recommended ModSecurity v3 config with minimal adjustments.

SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess Off
SecRequestBodyLimit 13107200
SecRequestBodyNoFilesLimit 131072
SecPcreMatchLimit 100000
SecPcreMatchLimitRecursion 100000
SecTmpDir /tmp
SecDataDir /tmp

# Default actions
# Note: OWASP CRS defines SecDefaultAction for phase:1 and phase:2 in its initialization rules.
# To avoid duplicate "SecDefaultActions can only be placed once per phase" errors,
# we do not set them here and rely on CRS defaults.

# Logging / Audit (overrides may toggle)
SecAuditEngine RelevantOnly
SecAuditLog /var/log/modsec_audit.log
SecAuditLogParts ABIJDEFHZ
SecAuditLogType Serial

# Unicode mapping (enabled). unicode.mapping is fetched at build.
# CRS setup is sourced from the system package's crs-setup.conf.example.
SecUnicodeMapFile unicode.mapping 20127

# Example custom rule placeholder (disabled)
# SecRule ARGS "@contains testtrigger" "id:100000,phase:1,pass,log,msg:'Test trigger'"
