# Passenger tuning (core directives passenger_root / passenger_ruby are set in nginx-main.conf)
# Keep only essentials here to avoid duplicate directive errors.
# No explicit pool caps; allow scaling per Passenger defaults/environment.
# passenger_pre_start is generated at startup from PASSENGER_PRESTART_URL (see entrypoint)

# Prefer disk-backed buffering to reduce memory spikes on large uploads
# Use per-app tmp paths under the application directory
passenger_temp_path /home/app/webapp/tmp/passenger;
passenger_buffer_upload on;
## Keep Nginx-level response buffering off to preserve streaming semantics
## passenger_buffer_response off;  # default

# Allow larger disk-backed response buffering so slow clients don't block app
# 256MB (268435456 bytes); set 0 for unlimited if needed
passenger_response_buffer_high_watermark 268435456;

# Allow more time for preloader startup on cold boots (slow DB, asset init)
passenger_start_timeout 120;
