{
    auto_https off
    # Enable HTTP/3 (QUIC) by default in Caddy
    servers {
        protocols h1 h2 h3
    }
}

localhost:3000 {
    tls /tmp/mkcert-dev-certs/localhost.pem /tmp/mkcert-dev-certs/localhost-key.pem
    reverse_proxy localhost:3002
    # Advertise HTTP/3 via Alt-Svc
    header Alt-Svc "h3=\":3000\"; ma=86400"

    # Allow same-site (different port) embeds when the caller has COEP enabled.
    # This is safe for local dev: it does NOT allow arbitrary cross-origin embedding.
    header Cross-Origin-Resource-Policy "same-site"
}
